import vertexai
from vertexai.generative_models import GenerativeModel
import vertexai.preview.generative_models as generative_models


def start_chat():
    # Initialize the Vertex AI environment
    vertexai.init(project="numeric-ion-425514-k6", location="us-central1")

    # Create an instance of the GenerativeModel
    model = GenerativeModel("gemini-1.5-flash-001")

    # Start the chat session
    chat = model.start_chat()

    # Define the configuration for generation and safety settings
    generation_config = {
        "max_output_tokens": 8192,
        "temperature": 1,
        "top_p": 0.95,
    }

    safety_settings = {
        generative_models.HarmCategory.HARM_CATEGORY_HATE_SPEECH: generative_models.HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
        generative_models.HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT: generative_models.HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
        generative_models.HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT: generative_models.HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
        generative_models.HarmCategory.HARM_CATEGORY_HARASSMENT: generative_models.HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
    }

    # Start chatting
    while True:
        user_input = input("You: ")

        # Exit loop if user types 'exit'
        if user_input.lower() == 'exit':
            break

        # Send user input to chatbot and print response
        response = chat.send_message([user_input], generation_config=generation_config, safety_settings=safety_settings)

        print("Bot:", response)


if __name__ == "__main__":
    start_chat()
